library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% nest(.by = c(topic,sub_topic))
books
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
head(books)
books %>% group_by(topic,sub_topic) %>% mutate(book_no = row_number())
32//25
32 %/% 25
books %>% mutate(virtual_shelf = book_no %/% 25)
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number())
books %<>% mutate(virtual_shelf = book_no %/% 25)
head(books)
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number())
books %<>% mutate(virtual_shelf = (book_no %/% 25)+1)
books %<>% nest(.by = c(topic,sub_topic))
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf = (book_no %/% 25)+1)
head(books)
unique(books$sub_topic)
unique(books$topic)
books %>% filter(topic == "building_tehcnology")
books %>% filter(topic == "building_technology")
books %>% filter(topic == "building technology")
books %>% filter(topic == "building technology") %>% View()
books %>% select(6:)
books %>% select(6,7)
books %>% select(7,8,10,12)
books %>% select(7,8,10)
unique(books$topic)
books %>% filter(topic == "arts and humanities") %>% View()
books %>% filter(topic == "arts and humanities") %>% select(7,8,10,12)
books %>% filter(topic == "arts and humanities") %>% select(7,8,10)
books %>% filter(topic == "arts and humanities") %>% select(7,8,10) %>%
group_by(topic, sub_topic) %>%
mutate(shelf = ceiling(row_number() / 5)) %>%
ungroup()
books %>% filter(topic == "arts and humanities") %>% select(7,8,10) %>%
group_by(sub_topic) %>%
mutate(shelf = ceiling(row_number() / 5)) %>%
ungroup() %>%
group_by(sub_topic, shelf) %>%
mutate(shelf_id = cur_group_id()) %>%
ungroup()
books %>% filter(topic == "arts and humanities") %>% select(7,8,10) %>%
group_by(sub_topic) %>%
mutate(shelf = ceiling(row_number() / 5)) %>%
ungroup() %>%
group_by(sub_topic, shelf) %>%
mutate(shelf_id = cur_group_id()) %>%
ungroup() %>% View()
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = (book_no %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books
books %>% View()
books %>% fiter(topic == "control engineering")
books %>% filter(topic == "control engineering")
books %>% filter(topic == "control engineering") %>% View()
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = (book_no %/% 25)+1)
books %<>% group_by(topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %>% filter(topic == "control engineering") %>% View()
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = (book_no %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% nest(.by = c(topic,virtual_shelf_temp))
books
head(books)
books %>% View()
books %>% View()
books %>% filter(topic == "sciences general")
books %>% filter(topic == "sciences general") %>% View()
View(.[[3]][[1]])
View(.[[3]][[1]])
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
head(books)
books %<>% select(topic,subtopic,oclc,cover_file)
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = (book_no %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,oclc,cover_file,virtual_shelf)
head(books)
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = (book_no %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
books %<>% nest(.by = c(topic,virtual_shelf))
books
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = (book_no %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
books
books %>% View()
books %<>% nest(.by = c(topic,virtual_shelf))
books
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = (book_no %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
books %>% View()
25 %/% 25
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = ((book_no -1 ) %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
books %<>% nest(.by = c(topic,virtual_shelf))
books
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = ((book_no -1 ) %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
#abooks %<>% nest(.by = c(topic,virtual_shelf))
books
books %>% filter(topic=="art")
books %>% filter(topic=="arts")
books %>% filter(topic=="arts and humanities")
books %>% filter(topic=="arts and humanities") %>% View()
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = ((book_no -1 ) %/% 10)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
books %>% filter(topic=="arts and humanities") %>% View()
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = ((book_no -1 ) %/% 5)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
#abooks %<>% nest(.by = c(topic,virtual_shelf))
books %>% filter(topic=="arts and humanities") %>% View()
books %>% filter(topic=="arts and humanities") %>% head(20)
json_data <- books %>%
group_by(topic, sub_topic, virtual_shelf) %>%
summarise(
books_in_bookcase = n(),
books = list(data.frame(OCLC, cover_file))
) %>%
ungroup() %>%
group_by(topic) %>%
summarise(
sub_topics = list(
list(
sub_topic = sub_topic,
virtual_shelf = virtual_shelf,
books_in_bookcase = books_in_bookcase,
books = books
)
)
) %>%
rowwise() %>%
mutate(
result = list(setNames(sub_topics, topic))
) %>%
pull(result) %>%
unlist(recursive = FALSE)
# Convert the list to JSON
json_output <- toJSON(json_data, pretty = TRUE, auto_unbox = TRUE)
library(jsonlite)
# Convert the list to JSON
json_output <- toJSON(json_data, pretty = TRUE, auto_unbox = TRUE)
json_output
write(json_output, file = paste0(curr_path,"/","virtual_bookshelves.json"))
head(books)
json_data <- books %>%
group_by(topic, sub_topic, virtual_shelf) %>%
summarise(
books_in_bookcase = n(),
books = list(data.frame(OCLC, cover_file))
)
json_data
json_data <- books %>%
group_by(topic, sub_topic, virtual_shelf) %>%
summarise(
books_in_bookcase = n(),
books = list(data.frame(OCLC, cover_file))
) %>%
ungroup()
head(json_data)
# Convert the list to JSON
json_output <- toJSON(json_data, pretty = TRUE, auto_unbox = TRUE)
write(json_output, file = paste0(curr_path,"/","virtual_bookshelves.json"))
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
library(jsonlite)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = ((book_no -1 ) %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
#abooks %<>% nest(.by = c(topic,virtual_shelf))
json_data <- books %>%
group_by(topic, sub_topic, virtual_shelf) %>%
summarise(
books_in_bookcase = n(),
books = list(data.frame(OCLC, cover_file))
) %>%
ungroup()
# Convert the list to JSON
json_output <- toJSON(json_data, pretty = TRUE, auto_unbox = TRUE)
write(json_output, file = paste0(curr_path,"/","virtual_bookshelves.json"))
books$cover_file[is.na(df$cover_file)] <- "NA"
books$cover_file[is.na(books$cover_file)] <- "NA"
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
library(jsonlite)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = ((book_no -1 ) %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
#abooks %<>% nest(.by = c(topic,virtual_shelf))
books$cover_file[is.na(books$cover_file)] <- "NA"
json_data <- books %>%
group_by(topic, sub_topic, virtual_shelf) %>%
summarise(
books_in_bookcase = n(),
books = list(data.frame(OCLC, cover_file))
) %>%
ungroup() %>%
rowwise() %>%
mutate(
result = list(setNames(sub_topics, topic))
) %>%
pull(result) %>%
unlist(recursive = FALSE)
json_data <- books %>%
group_by(topic, sub_topic, virtual_shelf) %>%
summarise(
books_in_bookcase = n(),
books = list(data.frame(OCLC, cover_file))
) %>%
ungroup() %>%
rowwise() %>%
mutate(
result = list(setNames(sub_topic, topic))
) %>%
pull(result) %>%
unlist(recursive = FALSE)
# Convert the list to JSON
json_output <- toJSON(json_data, pretty = TRUE, auto_unbox = TRUE)
write(json_output, file = paste0(curr_path,"/","virtual_bookshelves.json"))
library(openxlsx2)
library(dplyr)
library(magrittr)
library(tidyverse)
library(jsonlite)
curr_path = rstudioapi::getSourceEditorContext()$path
curr_path <- sub("/[^/]*$", "", curr_path)
books <- openxlsx2::read_xlsx(paste0(curr_path,"/","workshop_data.xlsx"))
books %<>% arrange(std_call_number)
books %<>% group_by(topic,sub_topic) %>% mutate(book_no = row_number()) %>% ungroup()
books %<>% mutate(virtual_shelf_temp = ((book_no -1 ) %/% 25)+1)
books %<>% group_by(sub_topic, virtual_shelf_temp) %>% mutate(virtual_shelf = cur_group_id()) %>% ungroup()
books %<>% select(topic,sub_topic,OCLC,cover_file,virtual_shelf)
#abooks %<>% nest(.by = c(topic,virtual_shelf))
books$cover_file[is.na(books$cover_file)] <- "NA"
json_data <- books %>%
group_by(topic, sub_topic, virtual_shelf) %>%
summarise(
books_in_bookcase = n(),
books = list(data.frame(OCLC, cover_file))
) %>%
ungroup() %>%
rowwise()
# Convert the list to JSON
json_output <- toJSON(json_data, pretty = TRUE, auto_unbox = TRUE)
write(json_output, file = paste0(curr_path,"/","virtual_bookshelves.json"))
head(books)
